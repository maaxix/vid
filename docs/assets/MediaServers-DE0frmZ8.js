import{j as e}from"./index-DGs7CRWL.js";import{b as r,u as b,c as g,L as N}from"./react-WPAQU5kY.js";import{m as f}from"./MediaServersService-vjLaEZ2q.js";function w({open:l,onClose:a,modalType:i="center",children:m}){const c=r.useRef(null),n=b(),o=g();return r.useEffect(()=>{if(!l)return;const t=y=>{y.key==="Escape"&&(n(-1),a())},u=o.pathname+o.search;n(u+"#modal",{replace:!1});const d=()=>{window.location.hash!=="#modal"&&a()};return window.addEventListener("popstate",d),document.body.style.overflow="hidden",window.addEventListener("keydown",t),()=>{document.body.style.overflow="",window.removeEventListener("keydown",t),window.removeEventListener("popstate",d),window.location.hash==="#modal"&&n(u,{replace:!0})}},[]),l?e.jsx("div",{ref:c,className:"modal-overlay",onClick:t=>{t.target===c.current&&(n(-1),a())},children:e.jsx("div",{className:`modal-content box1 p-4 rounded-lg shadow-lg overflow-hidden transform transition-all duration-300 ${L(i,l)}`,onClick:t=>t.stopPropagation(),children:m})}):null}function L(l,a){switch(l){case"top":return`${a?"translate-y-0 opacity-100":"-translate-y-full opacity-0"} mt-4`;case"bottom":return`${a?"translate-y-0 opacity-100":"translate-y-full opacity-0"} mb-4`;case"left":return`${a?"translate-x-0 opacity-100":"-translate-x-full opacity-0"} ml-4`;case"right":return`${a?"translate-x-0 opacity-100":"translate-x-full opacity-0"} mr-4`;case"full":return`${a?"scale-100 opacity-100":"scale-95 opacity-0"}`;case"center":default:return`${a?"scale-100 opacity-100":"scale-95 opacity-0"}`}}function K({open:l,onClose:a,onConfirm:i,title:m="Confirm",message:c="Are you sure?"}){const n=b();if(!l)return null;const o=()=>{i(),n(-1),a()},t=()=>{n(-1),a()};return e.jsxs(w,{open:l,onClose:a,modalType:"center",children:[e.jsx("div",{className:"card-title mb-4",children:m}),e.jsx("p",{className:"mb-8",children:c}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:t,className:"btn second",children:"Cancel "}),e.jsx("button",{onClick:o,className:"btn primary",children:"Confirm"})]})]})}function A({open:l,onClose:a,initial:i,onSave:m}){const c=b(),[n,o]=r.useState({name:"",url:"",apiKey:""}),[t,u]=r.useState({name:"",url:"",apiKey:""});r.useEffect(()=>{o(i||{name:"",url:"",apiKey:""})},[i]);const d=x=>{const{name:h,value:S}=x.target;o(p=>({...p,[h]:S})),t[h]&&u(p=>({...p,[h]:""}))},y=async()=>{const x=f.validateForm(n);x._error?u(x):(f.saveServer(n),c(-1),m(n))},j=()=>{c(-1),a()};return l?e.jsxs(w,{open:l,onClose:a,modalType:"bottom",children:[e.jsx("div",{className:"card-title mb-4",children:i?"Edit Server":"Add Server"}),e.jsxs("div",{className:"w-full min-w-500",children:[e.jsxs("div",{className:"fld",children:[e.jsx("input",{type:"text",name:"name",className:`fld-input ${t.name?"border-red-500":""}`,placeholder:"Name",value:n.name,onChange:d,disabled:!!i}),t.name&&e.jsx("div",{className:"fld-error text-red-500 text-sm mb-2",children:t.name})]}),e.jsxs("div",{className:"fld",children:[e.jsx("input",{type:"text",name:"url",className:`fld-input border p-2 rounded w-full mb-1 ${t.url?"border-red-500":""}`,placeholder:"URL",value:n.url,onChange:d}),t.url&&e.jsx("div",{className:"fld-error text-red-500 text-sm mb-2",children:t.url})]}),e.jsxs("div",{className:"fld",children:[e.jsx("input",{type:"text",name:"apiKey",className:`fld-input border p-2 rounded w-full mb-1 ${t.apiKey?"border-red-500":""}`,placeholder:"API Key",value:n.apiKey,onChange:d}),t.apiKey&&e.jsx("div",{className:"fld-error text-red-500 text-sm mb-2",children:t.apiKey})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:j,className:"btn second",children:"Cancel"}),e.jsx("button",{onClick:y,className:"btn primary",children:"Save"})]})})]}):null}function R(){const a=g().pathname,[i,m]=r.useState(""),[c,n]=r.useState([]),[o,t]=r.useState({}),[u,d]=r.useState(!1),[y,j]=r.useState(!1),[x,h]=r.useState(null),[S,p]=r.useState(null);r.useEffect(()=>{(async()=>{const v=f.getServerList();n(v)})()},[i]),r.useEffect(()=>{(async()=>{if(c.length>0){const v=await f.checkServerStatuses(c);t(v)}})()},[c]);const C=()=>{h(null),d(!0)},k=s=>{const v=f.findServerByName(s);v&&(h({...v}),d(!0))},E=s=>{p(s),j(!0)},$=()=>{S&&(f.deleteServer(S),p(null),m(new Date().toLocaleDateString())),j(!1)},D=s=>(f.saveServer(s),d(!1),m(new Date().toLocaleDateString()),!0);return e.jsxs("div",{className:"box",children:[e.jsxs("div",{className:"flex card-header",children:[e.jsx("span",{className:"grow card-title title-primary",children:"Server Manager"}),e.jsx("nav",{className:"",children:e.jsxs("button",{onClick:C,className:"btn second tooltip",children:["Add Server",e.jsx("span",{className:"tooltip-top tooltiptext",children:"Add Server"})]})})]}),e.jsx("div",{className:"card-body flex-col gap-6",children:c.map(s=>e.jsxs("div",{className:"card flex gap-2 box p-2",children:[e.jsxs(N,{to:`${a}/${s.name}`,className:"grow",children:[e.jsx("h4",{className:"text-lg font-semibold",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.url}),e.jsxs("p",{className:`text-sm mt-1 ${o[s.name]==="online"?"text-green-600":"text-red-600"}`,children:["Status: ",o[s.name]||"unknown"]})]}),e.jsxs("div",{className:"flex-start",children:[o[s.name]==="online"&&e.jsxs(N,{to:`${a}/${s.name}/settings`,className:"btn btn-icon",children:[e.jsx("i",{className:"icon icon-gear"}),"Settings"]}),e.jsx("button",{onClick:()=>k(s.name),className:"btn btn-icon",children:e.jsx("i",{className:"icon icon-edit"})}),e.jsx("button",{onClick:()=>E(s.name),className:"btn btn-icon",children:e.jsx("i",{className:"icon icon-del"})})]})]},s.name))}),e.jsx(A,{open:u,onClose:()=>d(!1),onSave:D,initial:x||void 0}),e.jsx(K,{open:y,onClose:()=>j(!1),onConfirm:$,title:"Delete Server",message:`Are you sure you want to delete server "${S}"?`})]})}export{R as default};
